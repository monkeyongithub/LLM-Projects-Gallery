# Advanced Multi-Agent ChatBot

<img width="2048" height="1475" alt="image" src="https://github.com/user-attachments/assets/5f10fd4a-c0d4-472b-900d-0471f8c0234a" />

一个功能丰富的多智能体聊天机器人系统，结合了现代化UI界面、多种响应模式和智能代理协作能力。

## 🌟 项目概述

这是一个基于Flask和LangChain构建的高级多智能体聊天机器人系统。项目集成了直接对话、知识检索（RAG）和多智能体协作三种响应模式，提供高度可配置的用户体验。

### 主要特性
- 🎯 **三种响应模式**: 直接响应、知识检索、多智能体深度思考
- 👥 **智能用户识别**: 新用户和回访用户的差异化处理
- ⚙️ **高度可配置**: 实时调整代理角色、限制话题、输出长度等参数
- 🤖 **多智能体协作**: Orchestrator协调多个专业代理协作处理复杂任务
- 🎨 **现代化UI**: 基于Tailwind CSS的深色主题界面
- 🔧 **易于扩展**: 模块化设计，方便添加新功能

## 📁 项目结构

```
project/
├── index.html          # 前端界面
├── app.py             # 后端Flask应用
└── utils.py           # 配置文件（需要用户自行创建）
```

## 🚀 快速开始

### 环境要求
- Python 3.8+
- pip 包管理器

### 安装步骤

1. **克隆或下载项目文件**

2. **创建虚拟环境（推荐）**
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# 或
venv\Scripts\activate     # Windows
```

3. **安装依赖包**
```bash
pip install flask langchain langchain-openai faiss-cpu
# 或使用requirements.txt（如有）
```

4. **创建配置文件**
在项目根目录创建 `utils.py` 文件，内容如下：
```python
OPENAI_CONFIG = {
    "apiKey": "your-api-key-here",
    "baseURL": "your-api-base-url-here"  # 例如: "https://api.openai.com/v1"
}

path = "."  # 项目根目录
```

5. **运行应用**
```bash
python app.py
```

6. **访问应用**
浏览器将自动打开 http://127.0.0.1:5000/

## 🖥️ 用户界面详解

### 侧边栏功能

#### 1. 用户体验设置
- **首次访问**: 系统会以新用户的身份接待，提供详细的介绍
- **回访用户**: 系统使用熟悉、友好的语气，避免重复介绍

#### 2. 系统设置
- **代理角色（Persona）**: 自定义AI助手的角色（如高级顾问、技术支持等）
- **限制话题**: 设置AI不应讨论的话题范围
- **最大输出长度**: 通过滑块控制响应内容的token数量（100-4000）
- **最大工具迭代次数**: 控制多智能体模式下工具调用的次数限制

#### 3. 实时代理状态
- **Orchestrator**: 显示核心调度代理的在线状态

#### 4. 实用工具
- **上传个人资料**: 模拟用户资料上传功能
- **清除对话**: 刷新页面重置会话

### 主聊天区域

#### 聊天窗口
- 显示用户和AI的对话历史
- 自动滚动到最新消息
- 消息气泡采用不同的颜色区分发送者

#### 输入区域
- **模式选择器**: 三种响应模式可选：
  - **PE（直接响应）**: 标准对话模式
  - **RAG（知识检索）**: 基于用户资料的智能检索
  - **Multi-Agent（多智能体）**: 复杂问题的深度思考模式
- **智能输入框**: 自适应高度的文本区域
- **状态栏**: 实时显示当前用户状态、token限制和响应模式

## 🔧 技术架构

### 前端技术栈
- **HTML5**: 页面结构
- **Tailwind CSS**: 现代化UI框架
- **Font Awesome**: 图标库
- **原生JavaScript**: 交互逻辑

### 后端技术栈
- **Flask**: 轻量级Web框架
- **LangChain**: AI应用开发框架
- **多智能体系统**: 
  - Orchestrator: 核心调度代理
  - 用户资料QA代理: 处理个人信息相关查询
  - 逻辑专家代理: 提供深度分析和架构建议
- **向量数据库**: FAISS用于知识检索

### 核心功能模块

#### 1. 用户状态管理
```python
# 根据用户类型调整对话语气
if is_new_user:
    tone = "礼貌并简要介绍能力"
else:
    tone = "热情友好，使用熟悉的问候语"
```

#### 2. 响应模式处理
- **PE模式**: 直接调用LLM，快速响应
- **RAG模式**: 结合用户资料进行检索增强生成
- **Multi-Agent模式**: 协调多个专业代理处理复杂问题

#### 3. 配置系统
- 实时配置更新，无需重启应用
- 配置参数包括角色设定、话题限制、输出限制等

## 📚 配置文件说明

### utils.py 结构
```python
# OpenAI API配置
OPENAI_CONFIG = {
    "apiKey": "your-api-key",          # 替换为你的API密钥
    "baseURL": "https://api.example.com"  # 自定义API端点
}

# 项目路径配置
path = "."  # 或指定绝对路径
```

### 支持的模型
- GPT-4o (默认)
- 兼容OpenAI API的任何模型

## 🛠️ 自定义与扩展

### 添加新的工具代理
1. 在 `app.py` 的 `tools` 列表中新增Tool对象：
```python
Tool(
    name="Your_Tool_Name",
    func=your_function,
    description="工具功能描述"
)
```

2. 实现相应的处理函数

### 修改UI主题
- 编辑 `index.html` 中的CSS变量
- Tailwind配置位于 `<style>` 标签和 `class` 属性中

### 扩展知识库
1. 修改 `setup_rag_agent()` 函数中的 `mock_data`
2. 或实现文件上传功能，动态构建向量数据库

## 🤝 使用示例

### 场景1：技术咨询
1. 设置代理角色为"高级技术顾问"
2. 选择"Multi-Agent"模式
3. 提问："如何设计一个高可用的微服务架构？"
4. 系统将协调多个代理提供综合建议

### 场景2：个人资料查询
1. 上传个人资料
2. 选择"RAG"模式
3. 提问："我之前有什么项目经验？"
4. 系统从上传资料中检索相关信息

### 场景3：快速问答
1. 选择"PE"模式
2. 直接提问简单问题
3. 获得即时响应

## ⚠️ 注意事项

1. **API配置**: 确保 `utils.py` 中的API配置正确
2. **依赖版本**: 建议使用最新的稳定版本库
3. **浏览器兼容**: 推荐使用Chrome或Edge最新版本
4. **资源限制**: 注意token限制和工具迭代次数，避免无限循环

## 🔮 未来扩展计划

- [ ] 实时语音输入/输出支持
- [ ] 多语言切换功能
- [ ] 对话历史保存与导出
- [ ] 插件系统支持第三方工具集成
- [ ] 移动端适配优化
- [ ] 性能监控面板

## 📄 许可证

本项目为开源项目，可用于学习和商业用途。使用前请确保遵守相关API服务条款。

## 🙏 致谢

- 感谢 [LangChain](https://github.com/langchain-ai/langchain) 提供的强大AI应用框架
- 感谢 [Tailwind CSS](https://tailwindcss.com/) 提供的优秀UI工具
- 感谢所有开源社区贡献者

## 🐛 问题反馈

如遇问题，请：
1. 检查控制台错误信息
2. 确认依赖包已正确安装
3. 验证API配置是否正确
4. 查看浏览器开发者工具的网络请求

欢迎提交Issue和Pull Request！

---

**开始使用**: 运行 `python app.py` 并访问 http://127.0.0.1:5000

**祝你使用愉快！🚀**
